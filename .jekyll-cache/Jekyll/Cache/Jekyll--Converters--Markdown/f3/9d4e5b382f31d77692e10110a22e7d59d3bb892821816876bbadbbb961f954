I"<h3 id="algolia-et-lindex">Algolia et lâ€™index</h3>

<p>Lorsque les articles se multiplient sur un blog, il est utile dâ€™ajouter une search bar afin que lâ€™utilisateur puisse retrouver ces articles par mots clÃ©s. 
Je vais donc vous expliquer les diffÃ©rentes Ã©tapes que jâ€™ai effectuÃ© pour installer une search Algolia dans mon projet jekyll.</p>

<ol>
  <li>
    <p>Nous devons dâ€™abord crÃ©er un compte <a href="https://www.algolia.com">Algolia</a>. Pour ma part jâ€™ai pris le â€œcommunity planâ€, le plan gratuit.</p>
  </li>
  <li>
    <p>Ensuite nous allons suivre le tutorial de base pour mieux comprendre le fonctionnement du produit. Il est simple, facile et rapide Ã  suivre.</p>
  </li>
  <li>
    <p>Une fois ce tutorial complÃ©tÃ©, nous pouvons aller dans le dashboard, et crÃ©er un nouvel index. 
 Lâ€™index reprÃ©sente la base de donnÃ©e dans laquelle se trouvera le contenu des articles que lâ€™on souhaite afficher dans le rÃ©sultat de la search:</p>

    <p><img src="/images/blogAlgoliaSite.png" alt="index" />
 Cliquer sur le lien â€œindiceâ€ Ã  gauche de lâ€™Ã©cran.</p>

    <p>Cliquer sur â€œnew indexâ€ en haut Ã  droite de la page.
 <img src="/images/index-alg.png" alt="index" /></p>
  </li>
</ol>

<h3 id="indexation-des-donnÃ©es">Indexation des donnÃ©es</h3>

<p>Nous allons maintenent procÃ©der Ã  lâ€™indexation des donnÃ©es : cela consiste Ã  importer les donnÃ©es sur lâ€™index que venons de crÃ©er.
Pour commencer nous allons consulter la page <a href="https://github.com/algolia/algoliasearch-jekyll">github algoliasarch-jekyll</a></p>

<ol>
  <li>
    <p>Sâ€™il nâ€™y a pas de gemfile dans notre projet, nous devons en crÃ©er un, puis ajouter la bonne version de jekyll, puis la gem Algolia search jekyll.</p>

    <noscript><pre>gem &#39;jekyll&#39;, &#39;3.0.1&#39;

</pre></noscript>
  </li>
</ol>
<p>group :jekyll_plugins do
  gem 'algoliasearch-jekyll', '~&gt; 0.8.0'
end&lt;/pre&gt;&lt;/noscript&gt;<script src="https://gist.github.com/camilleanelli/48c95a097446ff6dad1e0763a7563feb.js"> </script></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'bundle install'
</code></pre></div></div>

<ol>
  <li>
    <p>Dans le config.yml, on ajoute Ã©galement la gem - algoliasearch-jekyll</p>

    <noscript><pre>gems:
         - algoliasearch-jekyll</pre></noscript>
    <script src="https://gist.github.com/camilleanelli/9282330e021abd7905b97c604f1c9379.js"> </script>
  </li>
  <li>
    <p>Pour vÃ©rifier si lâ€™installation sâ€™est correctement effectuÃ©e, on exÃ©cute la commande -jekyll help. Une liste des sous-commandes Algolia doit alors sâ€™afficher.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jekyll help
</code></pre></div>    </div>

    <p>Si ce nâ€™est pas le cas, le problÃ¨me vient peu Ãªtre du faite quâ€™il manque des gem dans notre Gemfile.</p>
  </li>
  <li>Avant dâ€™aller plus loin, nous devons donc ajouter des gem manquantes dans le gemfile:
    <noscript><pre>gem &#39;jekyll-sitemap&#39;
gem &#39;jekyll-gist&#39;
gem &#39;jemoji&#39;</pre></noscript>
    <script src="https://gist.github.com/camilleanelli/958c7bb082e69af373fa75210d5293f0.js"> </script>

    <p>â€˜bundle installâ€™</p>
  </li>
  <li>
    <p>Une fois ces configurations terminÃ©es , il faut maintenant ajouter dans le config.yml:</p>

    <p>Mon application_id, situÃ© dans lâ€™onglet â€œkeys apiâ€ sur la gauche.</p>

    <p>Mon index_name, qui correspond au nom que nous donnons Ã  lâ€™index lors de sa crÃ©ation.</p>
  </li>
  <li>
    <p>En ligne de commande, on peu maintenant executer lâ€™import des donnÃ©es: 
 Sur mon compte Algolia, jâ€™ai 2 clÃ¨s dâ€™api, une â€˜read_only_keyâ€™, qui concerne la search uniquement et qui peu Ãªtre vue, et une â€˜write_api_keyâ€™ qui doit restÃ©e secrÃ¨te, câ€™est la clÃ¨s dâ€™admin.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ALGOLIA_API_KEY='write_api_key' jekyll algolia push
</code></pre></div>    </div>

    <p>Je remplace â€˜write_api_keyâ€™ par ma propre clÃ¨s dâ€™api dâ€™admin.</p>
  </li>
</ol>

<h3 id="affichage-de-la-search">Affichage de la search</h3>

<p>La derniÃ¨re Ã©tape est maintenant lâ€™affichage de la barre de search.
Câ€™est lâ€™Ã©tape qui mâ€™a paru la plus compliquÃ©e.
On peu se referer Ã  un thÃ¨me <a href="https://github.com/algolia/algoliasearch-jekyll-hyde">Hyde them</a>.</p>

<p>Une fois sur ce theme nous allons rÃ©cupÃ©rer le code qui va nous servir Ã  afficher la search, tout en permettant de faire des modifications.</p>

<p>Dans mon cas jâ€™ai souhaitÃ© mettre la search bar directement sur la page index et non dans une partial. Voici les Ã©tapes :</p>

<ol>
  <li>
    <p>Inclure le css dans les assets : algolia.scss, hyde.scss, et syntaxe.scss.</p>
  </li>
  <li>
    <p>Inclure le fichier Algolia.js dans les assets.</p>
  </li>
  <li>
    <p>Ne pas oublier dâ€™ajouter le lien vers notre fichier Algolia.js.</p>
  </li>
  <li>
    <p>Copier les scripts du footer dans notre footer. Les script inclus dans le footer sont indispensables pour faire apparaÃ®tre les resultats de la recherche.</p>

    <p><a href="https://github.com/algolia/algoliasearch-jekyll-hyde/blob/master/_includes/footer.html">_includes/footer.html</a>.</p>
  </li>
  <li>
    <p>On rÃ©cupÃ¨rer la balise &lt; input &gt; du fichier _includes/sidebar.html du projet hyde theme, quâ€™on place Ã  lâ€™endroit dÃ©sirÃ©.</p>

    <noscript><pre>&lt;input type=&quot;text&quot; class=&quot;algolia__input js-algolia__input&quot; autocomplete=&quot;off&quot; name=&quot;query&quot; placeholder=&quot;Search in this site...&quot; /&gt;</pre></noscript>
    <script src="https://gist.github.com/camilleanelli/103696d3d32118ff20fd6301ea84dda6.js"> </script>
  </li>
  <li>
    <p>RecupÃ©rer le contenue du layout default.html, et remplacer le content par notre propre code qui est censÃ© affichÃ© les articles sur la page index</p>

    <noscript><pre>   &lt;div class=&quot;algolia__initial-content js-algolia__initial-content&quot;&gt;
   &lt;div class=&quot;posts&quot;&gt;
     {% for post in site.posts %}
       &lt;div class=&quot;col-sm-4 padding-boxe&quot;&gt;
       &lt;a href=&quot;{{ site.baseurl }}{{ post.url }}&quot;&gt;
         &lt;div class=&quot;card-post&quot;&gt;
           &lt;h3 class=&quot;post-title&quot;&gt;
             {{ post.title }}
           &lt;/h3&gt;
           &lt;span class=&quot;post-date&quot;&gt;{{ post.date | date_to_string }}&lt;/span&gt;
         &lt;/div&gt;
       &lt;/a&gt;
       &lt;/div&gt;
       {% endfor %}
     &lt;/div&gt;
   &lt;/div&gt;</pre></noscript>
    <script src="https://gist.github.com/camilleanelli/661d7c112d7132181ce0a9e55184e41d.js"> </script>

    <p>Maintenant nous pouvons intervenir dans le css, et mÃªme le js pour modifier le design de la search. Par exemple, supprimer le scroll qui fait bouger la page vers le haut lors de la validation de la search, arrondir la forme de lâ€™input.</p>
  </li>
  <li>
    <p>Voici le rÃ©sultat obtenu</p>

    <p><img src="/images/algoliaResultblog.png" alt="result" /></p>

    <p>On a bien une search installÃ©e, quâ€™on pourra bien sÃ»re amÃ©liorer en fonction de notre thÃ¨me.</p>
  </li>
</ol>

:ET